# PHP

version: '2'

services:

  phpfpm:
    build: ./.docker/images/php-fpm
    volumes:
      - ./.docker/images/php-fpm/php-fpm.conf:/usr/local/etc/php-fpm.conf
      - ./.docker/images/php-fpm/php.ini:/usr/local/etc/php/php.ini
      - /Users/wangxiaohua/php/ddapi:/var/www/html

  nginx-app:
    image: nginx
    ports:
      - "80:80"
    volumes:
      - ./.docker/images/nginx/vhost.conf:/etc/nginx/conf.d/default.conf
      - /Users/wangxiaohua/php/ddapi:/var/www/html

  php-worker-host:
    build: ./.docker/images/php-work
    volumes:
      - /Users/wangxiaohua/php/ddapi:/usr/share/nginx/html/ddapi
    command: php artisan queue:work --daemon --queue=host

  php-worker-tag:
    build: ./.docker/images/php-work
    volumes:
      - /Users/wangxiaohua/php/ddapi:/usr/share/nginx/html/ddapi
    command: php artisan queue:work --daemon --queue=tag

  php-worker-metric:
    build: ./.docker/images/php-work
    volumes:
      - /Users/wangxiaohua/php/ddapi:/usr/share/nginx/html/ddapi
    command: php artisan queue:work --daemon --queue=metric
